# ğŸ”§ URIä¿®å¤éªŒè¯æŒ‡å—

## ğŸ“‹ é—®é¢˜æ€»ç»“
å‘ç°å¹¶ä¿®å¤äº†å¯¼è‡´AI APIè°ƒç”¨å¤±è´¥çš„å…³é”®Bugï¼š
- **æ ¹æœ¬åŸå› **ï¼š`DeepSeekApiServiceImpl.java:123` ä½¿ç”¨ç©ºURI `.uri("")`
- **ä¿®å¤æ–¹æ¡ˆ**ï¼šæ”¹ä¸º `.uri("/v1/chat/completions")`
- **ç«‹å³æ–¹æ¡ˆ**ï¼šå¯ç”¨Mockæ¨¡å¼ç»•è¿‡é—®é¢˜

## ğŸ¯ å½“å‰çŠ¶æ€
1. âœ… **ä»£ç å·²ä¿®å¤**ï¼šURIé—®é¢˜å·²è§£å†³
2. âœ… **Mockæ¨¡å¼å·²å¯ç”¨**ï¼š`application.yml` ä¸­è®¾ç½® `mock.enabled: true`
3. â³ **ç­‰å¾…é‡å¯**ï¼šéœ€è¦é‡æ–°ç¼–è¯‘å’Œå¯åŠ¨åº”ç”¨

## ğŸš€ éªŒè¯æ­¥éª¤

### æ­¥éª¤1ï¼šéªŒè¯åº”ç”¨è¿è¡ŒçŠ¶æ€
```bash
# æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ
netstat -ano | findstr :8080
```

### æ­¥éª¤2ï¼šæµ‹è¯•Mockæ¨¡å¼
```bash
# ä½¿ç”¨curlæµ‹è¯•ï¼ˆæ¨èï¼‰- æ³¨æ„æ­£ç¡®çš„APIè·¯å¾„
curl -X POST http://localhost:8080/admin-api/business/ai-score/generate \
  -H "Content-Type: application/json" \
  -d "{\"patientId\": 4360}"

# æˆ–è€…ä½¿ç”¨PowerShell
Invoke-RestMethod -Uri "http://localhost:8080/admin-api/business/ai-score/generate" -Method POST -Headers @{"Content-Type"="application/json"} -Body '{"patientId": 4360}'

# æˆ–è€…ç›´æ¥è¿è¡Œæµ‹è¯•è„šæœ¬
.\test_correct_api.ps1
```

### æ­¥éª¤3ï¼šéªŒè¯Mockå“åº”æ ¼å¼
æœŸæœ›çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å“åº”ï¼š
```json
{
  "code": 200,
  "msg": "æˆåŠŸ",
  "data": {
    "scoreResponse": {
      "totalScore": 85,
      "level": "ä¹™çº§",
      "details": [
        {
          "item": "ä¸»è¯‰",
          "fullScore": 10,
          "score": 8,
          "deduction": "ä¸»è¯‰æè¿°è¾ƒä¸ºæ¸…æ™°"
        }
        // ... æ›´å¤šè¯¦æƒ…
      ]
    },
    "aiPrompt": "ä½ æ˜¯åŒ»ç–—è´¨æ§ä¸“å®¶...",
    "aiRequestJson": "...",
    "aiResponseJson": "..."
  }
}
```

### æ­¥éª¤4ï¼šé‡æ–°ç¼–è¯‘å’Œæµ‹è¯•çœŸå®API
å¦‚æœè¦æµ‹è¯•ä¿®å¤åçš„çœŸå®AI APIï¼š

1. **åœæ­¢åº”ç”¨**ï¼šåœ¨è¿è¡Œåº”ç”¨çš„ç»ˆç«¯æŒ‰ `Ctrl+C`

2. **ä¿®æ”¹é…ç½®**ï¼šå°† `application.yml` ä¸­çš„ `mock.enabled` æ”¹ä¸º `false`

3. **é‡æ–°ç¼–è¯‘**ï¼š
```bash
mvn clean install
```

4. **é‡æ–°å¯åŠ¨**ï¼š
```bash
.\start.bat
```

5. **æµ‹è¯•çœŸå®API**ï¼š
```bash
curl -X POST http://localhost:8080/admin-api/business/ai-score/generate \
  -H "Content-Type: application/json" \
  -d "{\"patientId\": 4360}"
```

### æ­¥éª¤5ï¼šæŸ¥çœ‹æ—¥å¿—
é‡æ–°å¯åŠ¨åï¼Œåº”è¯¥èƒ½åœ¨æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
```
AIè¯·æ±‚ä½“: {"model":"Qwen/Qwen3-8B","messages":[...]}
```

## ğŸ“Š é¢„æœŸç»“æœ

### Mockæ¨¡å¼ï¼ˆå½“å‰ï¼‰
- âœ… ç«‹å³è¿”å›è¯„åˆ†ç»“æœ
- âœ… åŒ…å«å®Œæ•´çš„è°ƒè¯•ä¿¡æ¯
- âœ… éšæœºä½†åˆç†çš„åˆ†æ•°ï¼ˆ75-95åˆ†ï¼‰

### çœŸå®APIæ¨¡å¼ï¼ˆä¿®å¤åï¼‰
- âœ… æˆåŠŸè°ƒç”¨SiliconFlow API
- âœ… è¿”å›AIç”Ÿæˆçš„è¯„åˆ†
- âœ… æ—¥å¿—æ˜¾ç¤ºå®Œæ•´è¯·æ±‚ä¿¡æ¯
- âœ… ä¸å†å‡ºç°400 Bad Requesté”™è¯¯

## ğŸ” æ•…éšœæ’é™¤

### å¦‚æœMockæ¨¡å¼ä¸å·¥ä½œ
1. æ£€æŸ¥åº”ç”¨æ˜¯å¦é‡æ–°åŠ è½½äº†é…ç½®
2. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
3. ç¡®è®¤ `MockDeepSeekApiServiceImpl` æ˜¯å¦è¢«SpringåŠ è½½

### å¦‚æœçœŸå®APIä»ç„¶å¤±è´¥
1. ç¡®è®¤åº”ç”¨å·²é‡æ–°ç¼–è¯‘ï¼ˆæŸ¥çœ‹JARæ–‡ä»¶æ—¶é—´æˆ³ï¼‰
2. æ£€æŸ¥æ—¥å¿—ä¸­æ˜¯å¦æœ‰"AIè¯·æ±‚ä½“"è¾“å‡º
3. éªŒè¯SiliconFlow APIæœ¬èº«æ˜¯å¦å¯ç”¨

## ğŸ“ æŠ€æœ¯æ”¯æŒ
å¦‚é‡é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. åº”ç”¨å¯åŠ¨æ—¥å¿—
2. APIè°ƒç”¨å“åº”
3. é”™è¯¯ä¿¡æ¯è¯¦æƒ… 